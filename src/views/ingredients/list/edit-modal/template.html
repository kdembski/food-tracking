<CModal
  v-model:isOpen="_isOpen"
  :title="getTitle()"
  :submitButtonLabel="getSubmitButtonLabel()"
  :isSubmitting="isSubmitting"
  @submit="submit"
>
  <EditIngredientModalLoader v-if="isLoading" />
  <div v-else class="edit-ingredient-modal">
    <CInput
      v-model="ingredient.name"
      label="Nazwa skÅ‚adnika"
      :errorMessage="getErrorMessage(['name'])"
      @input="clearError(['name'])"
    />
    <CAutocomplete
      v-model="ingredient.categoryId"
      :options="categoryOptions"
      label="Kategoria"
      :errorMessage="getErrorMessage(['categoryId'])"
      @update:modelValue="clearError(['categoryId'])"
    />
    <div class="units">
      <div class="units__header">Jednostki</div>
      <div class="units__headings">
        <p>Nazwa</p>
        <p>Kalorie</p>
        <p>Konwerter</p>
      </div>
      <div class="units__wrapper">
        <CMultiInput
          v-model="ingredient.units"
          :type="MultiInputValuesTypes.OBJECT"
          @itemRemove="onUnitRemove"
        >
          <template #default="{ values, index }">
            <div class="units__item" :key="values[index].id">
              <div class="primary-unit-radio-set">
                <CRadio
                  v-model="selectedPrimaryIndex"
                  name="primary-unit-radio-set"
                  :value="index"
                />
              </div>
              <CAutocomplete
                v-model="values[index].unitId"
                :options="unitOptions"
                :errorMessage="getErrorMessage(['units', index, 'unitId'])"
                @update:modelValue="clearError(['units', index, 'unitId'])"
              />
              <CInput
                v-model="values[index].kcalPerUnit"
                type="number"
                :errorMessage="getErrorMessage(['units', index, 'kcalPerUnit'])"
                @input="clearError(['units', index, 'kcalPerUnit'])"
              />
              <CInput
                v-model="values[index].converterToPrimary"
                type="number"
                :isDisabled="selectedPrimaryIndex == index"
                :errorMessage="getErrorMessage(['units', index, 'converterToPrimary'])"
                @input="clearError(['units', index, 'converterToPrimary'])"
              />
            </div>
          </template>
        </CMultiInput>
      </div>
    </div>
  </div>
</CModal>
