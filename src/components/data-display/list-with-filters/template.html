<div class="list-with-filters">
  <transition name="list-with-filters__filters-transition">
    <div
      v-show="!isMobile || areMobileFiltersOpen"
      class="list-with-filters__filters filters"
    >
      <CCard class="filters__wrapper">
        <p
          v-if="getTotalCountText() && !_isLoading"
          class="filters__total-count"
        >
          {{ getTotalCountText() }}
        </p>
        <CSkeletonLoader
          v-else-if="_isLoading"
          style="height: 14px; width: 40%"
        />
        <div class="filters__btns-container">
          <CButton
            color="secondary"
            size="small"
            label="Wyczyść filtry"
            icon="times"
            class="filters__clear-btn"
            :isLoading="_isLoading"
            :isDisabled="areFiltersEqualToDefault()"
            @click="clearFilters"
          />
          <CButton
            v-if="enableRandomButton"
            color="secondary"
            size="small"
            label="Wylosuj"
            icon="question"
          />
        </div>
        <div class="filters__search-by search-by">
          <CSlider
            v-if="isSearchBySliderVisible"
            id="filters-search-by"
            v-model="inputFilterBy"
            :options="inputFilterByOptions"
            class="search-by__slider"
          />
          <CInput
            v-if="inputFilterBy === 'byName'"
            id="search-by-name"
            :modelValue="filters.searchPhrase"
            @update:modelValue="filterBySearchPhrase"
            class="search-by__input"
            :class="{ 'search-by__input--with-slider': isSearchBySliderVisible }"
            icon="magnifying-glass"
            placeholder="Szukaj po nazwie"
            :isLoading="_isLoading"
            label="Szukaj"
          />
          <CAutocomplete
            v-else
            id="search-by-tags"
            v-model="inputSelectedTag"
            :options="getAvailableTagsOptions(filters.tags)"
            @update:modelValue="addTagAndFilter"
            shootingMode
            class="search-by__input"
            :class="{ 'search-by__input--with-slider': isSearchBySliderVisible }"
            icon="magnifying-glass"
            placeholder="Szukaj po tagach"
            :isLoading="_isLoading"
            label="Szukaj"
          />
        </div>
        <div class="filters__sort-by">
          <CInput label="Sortuj" />
        </div>
        <div v-if="enableTags" class="filters__select-tags">
          <p>Dostępne tagi</p>
          <CSelectTags
            :selectedTags="filters.tags"
            @update:selectedTags="filterByTags"
            :tags="availableTags"
            :isLoading="_isLoading"
          />
        </div>
      </CCard>
    </div>
  </transition>
  <transition name="list-with-filters__content-transition">
    <div
      v-show="!isMobile || !areMobileFiltersOpen"
      class="list-with-filters__content"
      ref="content"
    >
      <CList :items="list?.data" :isLoading="_isLoading">
        <template v-slot:default="{ item }">
          <slot :item="item" :addTagAndFilter="addTagAndFilter"></slot>
        </template>
      </CList>
      <CPagination
        class="list-with-filters__pagination"
        :currentPage="filters.currentPage"
        @update:currentPage="changeCurrentPage"
        :paginationData="list?.pagination"
        :isLoading="_isLoading"
      />
    </div>
  </transition>
  <button
    v-if="isMobile"
    class="list-with-filters__toggle-mobile-filters"
    :style="mobileBtnStyle"
    @touchmove.prevent="onMobileBtnTouchMove"
    @touchstart="onMobileBtnTouchStart"
    @click="toggleFiltersOnMobile"
  >
    <FontAwesomeIcon
      :icon="areMobileFiltersOpen ? 'list' : 'magnifying-glass'"
    />
  </button>
</div>
