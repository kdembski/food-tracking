<div class="list-with-filters">
  <transition name="list-with-filters__filters-transition">
    <div
      v-if="!isMobile || areMobileFiltersOpen"
      class="list-with-filters__filters filters"
    >
      <CCard class="filters__wrapper">
        <div class="filters__btns-container">
          <CButton
            color="secondary"
            size="small"
            label="Wyczyść filtry"
            icon="times"
            class="filters__clear-btn"
            :isLoading="_isLoading"
            :isDisabled="areFiltersEqualToDefault()"
            @click="clearFilters"
          />
          <CButton
            color="secondary"
            size="small"
            label="Wylosuj"
            icon="question"
          />
          <CButton
            v-if="isMobile"
            color="secondary"
            label=""
            size="small"
            icon="times"
            @click="toggleFiltersOnMobile"
          />
        </div>
        <div class="filters__search-by search-by">
          <CSlider
            v-if="!_isLoading"
            id="filters_search_by"
            v-model="inputFilterBy"
            :options="inputFilterByOptions"
            class="search-by__slider"
          />
          <CInput
            v-if="inputFilterBy === 'byName'"
            :modelValue="filters.searchPhrase"
            @update:modelValue="filterBySearchPhrase"
            class="search-by__input"
            icon="magnifying-glass"
            placeholder="Szukaj po nazwie"
            :isLoading="_isLoading"
            label="Szukaj"
          />
          <CAutocomplete
            v-else
            v-model="inputSelectedTag"
            :options="availableTagsOptions"
            @update:modelValue="addTagAndFilter"
            shootingMode
            class="search-by__input"
            icon="magnifying-glass"
            placeholder="Szukaj po tagach"
            :isLoading="_isLoading"
            label="Szukaj"
          />
        </div>
        <div class="filters__sort-by">
          <CInput label="Sortuj" />
        </div>
        <div class="filters__select-tags">
          <p>Dostępne tagi</p>
          <CSelectTags
            :selectedTags="filters.tags"
            @update:selectedTags="filterByTags"
            :tags="availableTags"
            :isLoading="_isLoading"
          />
        </div>
      </CCard>
    </div>
  </transition>
  <transition name="list-with-filters__content-transition">
    <div
      v-if="!isMobile || !areMobileFiltersOpen"
      class="list-with-filters__content"
      ref="content"
    >
      <CList
        :items="list?.data"
        :isLoading="_isLoading"
        @sortChange="filterBySort"
      >
        <template v-slot:default="{ item }">
          <slot :item="item" :addTagAndFilter="addTagAndFilter"></slot>
        </template>
      </CList>
      <CPagination
        class="list-with-filters__pagination"
        :currentPage="filters.currentPage"
        @update:currentPage="changeCurrentPage"
        :paginationData="list?.pagination"
        :isLoading="_isLoading"
      />
    </div>
  </transition>
  <button
    v-if="isMobile"
    class="list-with-filters__toggle-mobile-filters"
    :style="mobileBtnStyle"
    @touchmove.prevent="onMobileBtnTouchMove"
    @touchstart="onMobileBtnTouchStart"
    @click="toggleFiltersOnMobile"
  >
    <FontAwesomeIcon :icon="areMobileFiltersOpen ? 'list' : 'filter'" />
  </button>
</div>
